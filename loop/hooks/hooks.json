{
  "hooks": {
    "Setup": [
      {
        "matcher": "init",
        "hooks": [
          {
            "type": "command",
            "command": "mkdir -p ~/.claude/loop"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Check if an autonomous loop is active. Input: $ARGUMENTS\n\nFIRST: Is there an active loop task with [LOOP] announcements in the transcript?\n- If NO loop is active, return: {\"ok\": true}\n- If loop IS active, evaluate:\n  1. Did the last message contain <loop-complete>? Stop.\n  2. Has stop_hook_active been true 3+ times? Stop.\n  3. Otherwise, continue.\n\nRESPOND WITH ONLY JSON (no explanation):\n{\"ok\": true} to allow stop\n{\"ok\": false, \"reason\": \"next: [action]\"} to continue loop\n\nJSON ONLY:",
            "timeout": 30
          }
        ]
      }
    ]
  }
}
